---
title: "2章_無作為化割付けによる分析"
output: html_document
date: '2022-05-14'
---
# データ（数学の試験成績）の読込み
```{r}
rm(list = ls())
d <- read.csv("data02.csv")
attach(d)
```
```{r}
head(d)
```

# 無作為化割付けによる分析
```{r}
set.seed(1)
r0 <- runif(20, 0, 1)　# 区間[0,1]の20個の一様乱数を生成
r1 <- round(r0, 0)　   # 四捨五入して0と1に変換 
y2 <- NULL              # 空の変数を生成
y2[r1==1] <- y1t[r1==1] # コイン投げの結果が1の時、潜在的結果変数y1tが値になる
y2[r1==0] <- y0t[r1==0] # コイン投げの結果が0の時、潜在的結果変数y0tが値になる
r1
y2
```
# 平均処置効果の推定
```{r}
mr1 <- mean(y2[r1==1])  # コイン投げの結果が1（表）だった人の期末試験y2の平均値
mr0 <- mean(y2[r1==0])  # コイン投げの結果が0（裏）だった人の期末試験y2の平均値

mr1
mr0
mr1 - mr0
```
# 2標本t検定
コイン投げの結果が1（表）だった人と0（裏）だった人の期末試験y2の平均値の差をt検定で判定する。
```{r}
t.test(y2[r1==1], y2[r1==0], var.equal = FALSE)
```
95%信頼区間は4.219〜20.811であり、0が含まれていないため、2つの集団の差は5%水準で有意である。
